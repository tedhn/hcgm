generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// / This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Admin {
  id          Int           @id @default(autoincrement())
  code        String?       @default("")
  name        String?       @default("")
  email       String?       @unique @default("")
  phone       String?       @default("")
  role        String?       @default("")
  password    String?       @default("")
  created_at  DateTime      @default(now()) @db.Timestamptz(6)
  Transaction Transaction[]
}

model Customer {
  id                  Int      @id @default(autoincrement())
  code                String   @default("")
  name                String   @default("")
  ssmRegistrationNo   String?  @default("")
  taxIdentificationNo String?  @default("")
  sstNo               String?  @default("")
  msicCode            String?  @default("")
  businessNature      String?  @default("")
  picName             String?  @default("")
  email               String?  @unique @default("")
  phoneNo             String?  @default("")
  address             String?  @default("")
  creditTerm          String   @default("")
  adminId             Int      @default(0)
  creditLimit         Float    @default(0)
  created_at          DateTime @default(now()) @db.Timestamptz(6)

  Transaction Transaction[]
}

model Product {
  id        Int    @id @default(autoincrement())
  code      String @default("")
  name      String @default("")
  category  String @default("")
  baseUom   String @default("")
  stock     Int  @default(0)
  unitPrice Float  @default(0)

  Transaction_Detail Transaction_Detail[]
}

model Transaction {
  id              Int       @id @default(autoincrement())
  docNum          String    @default("")
  transactionDate DateTime  @default(now()) @db.Timestamptz(6)
  customer        Customer  @relation(fields: [customerId], references: [id])
  customerId      Int       @default(0)
  admin           Admin     @relation(fields: [adminId], references: [id])
  adminId         Int       @default(0)
  totalPrice      Float     @default(0)
  refDocNo        String?   @default("")
  deliveryDate    DateTime?
  shippingMethod  String?   @default("")
  commission      Float?    @default(0)
  remark          String?   @default("")
  status          String    @default("")

  Transaction_Detail Transaction_Detail[]
}

model Transaction_Detail {
  id            Int         @id @default(autoincrement())
  transaction   Transaction @relation(fields: [transactionId], references: [id])
  transactionId Int
  product       Product     @relation(fields: [productId], references: [id])
  productId     Int
  qty           Int
  unitPrice     Float
}
